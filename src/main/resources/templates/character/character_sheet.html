<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
	<section th:replace="fragments/theme/head :: head('Character Sheet')"></section>
	<head>
		<!-- Page-specific CSS / JS -->
		<script th:src="@{js/form.js}"></script>
		<script th:src="@{js/character-sheet.js}"></script>
	</head>

	<body>
		<section th:replace="fragments/theme/nav('Character Sheet')"></section>
	
		<div class="single">
			<div class="container">
	
				<!-- Error Messages -->
				<div class="row">
					<div class="alert alert-dismissable alert-danger bad-login"
						th:if="${errors != null and not #lists.isEmpty(errors)}">
						<th:block data-th-each="error : ${errors}">
							<p th:text="${error}">|Error message here.|</p>
						</th:block>
					</div>
				</div>
	
				<div class="row">
					<div class="col-md-6 col-md-offset-4"> <!-- Half the whole page. -->
						<div class="col-md-6 portrait-column"> <!-- Half of the half. -->
							<div class="portrait-container">
								<!-- Character Portrait -->
								<div class="shine-on-hover column">
									<figure>
										<img id="characterPortrait" th:src="${character?.image}" class="img-responsive portrait" />
									</figure>
								</div>
					
								<!-- Character Class -->
								<div class="portrait-label">
									<h4><span id="classLabel" th:text="${character?.charClass?.name}"></span></h4>
								</div>			
							</div>
							
							<div th:switch="${editMode}"  class="portrait-element">
								<!-- Edit Buttons -->
								<div th:case="false" class="row">
									<form id="editForm" method="post" th:action="'/editCharacterSheet?id=' + ${character?.id}">
										<h1 th:replace="fragments/theme/elements :: button(editBtn, Edit)"></h1>
									</form>
								</div>
					
								<div th:case="*" class="row">
									<h1 th:replace="fragments/theme/elements :: button(saveBtn, Save)"></h1>
									<h1 th:replace="fragments/theme/elements :: button(cancelBtn, Cancel)"></h1>
									<script th:inline="javascript">
										/*<![CDATA[*/
										$('#cancelBtn').click(function() {
											cancelCharacterSheet(/*[[${character?.id}]]*/);
										});
										/*]]>*/
									</script>
								</div>
							</div>
						</div>
					</div>
				</div>
	
				<!-- Character Info -->
				<div class="row">
					<form id="saveForm" method="post" th:action="'/characterSheet?id=' + ${character?.id}" th:object="${characterSheetValidator}">
						<section th:replace="fragments/ui/character/stats_table :: stats_table('false')"></section>
					
						<div class="col-md-6">
							<table class="table table-hover lower">
								<thead>
									<tr>
										<th>Property Name</th>
										<th>Property Value</th>
									</tr>
								</thead>
								
								<tbody>
									<tr>
										<td>Hit Die</td>
										<td id="hitDie" th:if="${editMode == false}" th:text="${character?.charSheet?.hitDie}"></td>
										<td th:if="${editMode == true}"><input id="hitDie" name="hitDie" th:value="${character?.charSheet?.hitDie}" /></td>
									</tr>
									<tr>
										<td>Hit Points</td>
										<td th:if="${editMode == false}">
											<div id="progressBarParent" class="progress">
												<div id="hpProgressBar">
													<div id="hpText">
														<center>
															<span id="hpBarCurrent" th:text="${character?.charSheet?.currentHp}"></span> / <span id="hpBarMax" name="maxHp" th:text="${character?.charSheet?.maxHp}"></span>
														</center>
													</div>
												</div>
											</div>
										</td>
										<td th:if="${editMode == true}"><input id="currentHp" name="currentHp" th:value="${character?.charSheet?.currentHp}" /></td>
									</tr>
									<tr th:if="${editMode == true}">
										<td>Max Hit Points</td>
										<td th:if="${editMode == true}"><input id="maxHp" name="maxHp" th:value="${character?.charSheet?.maxHp}" /></td>
									</tr>
									<tr>
										<td>Initiative</td>
										<td name="dexMod"></td>
									</tr>
									<tr>
										<td>Size Mod</td>
										<td id="sizeMod" th:text="${character?.size?.value}"></td>
									</tr>
								</tbody>
							</table>
						</div>
					</form>
				</div>
					
				<p th:if="${editMode == false}" class="dolor"></p>
				
				<!-- Tip Panes -->
				<section th:replace="fragments/ui/character/tips_combat_pane"></section>
					
				<div th:if="${editMode == false}">
					<script>
						disableFormElements();
					</script>
				</div>
	
			</div>
		</div>
	
	</body>
</html>